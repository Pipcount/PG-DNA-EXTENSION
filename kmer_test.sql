DROP TABLE IF EXISTS kmers; 
DROP TABLE IF EXISTS DNAs;
DROP TABLE IF EXISTS qkmers;
DROP TABLE IF EXISTS large_table;
drop index if exists large_table_kmer_idx;

DROP EXTENSION IF EXISTS kmea;

CREATE EXTENSION kmea;
CREATE TABLE kmers(id integer, kmer kmer);
CREATE TABLE DNAs(id integer, dna DNA);
CREATE TABLE qkmers(id integer, qkmer qkmer);

INSERT INTO kmers VALUES 
(1, 'ACGTT'),
(2, 'ACTGTTTTTTT'),
(3, 'A'),
(4, 'ATCTACTCATCATACTGATCGATTAGat'),
(5, 'ACGAC'),
(6, 'ACGGG');

SELECT * FROM kmers;
select length(kmer), kmer from kmers;
SELECT * FROM kmers WHERE equals('ACGTT', kmer);
SELECT * FROM kmers WHERE kmer = 'ACGTA';
SELECT * FROM kmers WHERE kmer ^@ 'ACGTA';
SELECT * FROM kmers WHERE kmer ^@ 'ACGT';

INSERT INTO DNAs VALUES 
(1, 'ATCGG'),
(2, 'ATATATATATATATATA');

INSERT INTO DNAs VALUES
(3, dna('AAG'));

SELECT * FROM DNAs;

select length(dna), dna
from DNAs;

select k.kmer
from generate_kmers('ACGTACGT', 4) as  k(kmer)
WHERE k.kmer ^@ 'ACGT';

INSERT INTO qkmers VALUES 
(1, 'ACM'),
(2, 'GTNW'),
(3, 'ANMAAAAAAAAAA');

select * from qkmers;

select kmer as "Matches ACGNW"
from kmers
where 'ACGNW' @> kmer;

select length(qkmer), qkmer
from qkmers;


/* Test the kmer_count function */
select count(*)
from DNAs;

select k.kmer, count(*)
from generate_kmers('ACTGACTG', 4) as k(kmer)
group by k.kmer
order by count(*) desc;


with mykmers as (
    select k.kmer, count(*)
    from generate_kmers('ACTGACTG', 4) as k(kmer)
    group by k.kmer
)
select sum(count) as "Total kmers", count(*) as "Distinct kmers", count(*) filter (where count = 1) as "Unique kmers"
from mykmers;


-- Create the table
CREATE TABLE large_table(
    id serial primary key, 
    kmer kmer
);

insert into large_table (kmer)
select k.kmer
from generate_kmers('ACATGAAAGCCGACTGTGTCCCCGATGGGGCGTTAATCCCCACGACAAGGCGGTAAAAAGATCACTGACACCGCTGTTCTTCGAAAGAACCGAGGTGGTCAGGCGGACGTGGGGGCCCGTTCTGGGCCGGCAGAGTTATAGAACCGCTACGCAGACTCTCAAGCCTCAGCATTAGCCCTCAAACGACCTCAGACGCTCTTGCGCCAGCGATTACTCTAGTGCTCTGAAGGTACATCTTTGACAAGGAGATCGTCTGCTAGCGGACTATTAGAACTGCCGTCTGGCAAAGTCCGCAACTGGGAATACACGGTTCCCTAGTTGCAGTGCCTTGTAGAGAGATCGATCTAAATCCCTATCTCCGCATTCGGACTCCCAGCGAGTCCAACGGGTGTGTGATCAGTAATATCGGCTTAAGCAGGGAGCAATAAGGTATTGAGCTATTACCCCTCTTTCCAGGGACGCCGTACCCGAACATCCGTCACAAAGGGACTCTGCGATGAGAGGGCCTATATATACCCTTGCAACGGACCAACTACGCTAAGGAGAATACAAACCGGGAGTGGAATTCGCCGGTAGGAAGAATGTGAGGTAGTTCTGGAACTGCCCTAACACGGGATATTGTCTGCGATAGACAGGGTCATCCGGAGGAATGACATACACTATTTTGTGCTTTCCAAGTAGGAATCCATATGCGTCATCATTTTACGTTACTGTGATACTCACAGACCGTTGTACAGTAGCTACCCAATAGTCAAGCCAGTCTAAAGTAGACAAAGCGAGTGCCATAACACGTGGGCCATTCTAACGAACTCGTCGGCAGGTATGCTTCCGTTTGCCTATCATCCCAGTAGCGGGCCGCGGTCTGTCCATTCGGGGAAATCAGGCATTCTGAAAATCATCGACAGATGCGTCCGTAATAGTGCGAGGATGGCTCAATCACTCTAGTTAACACTGACATTAACAACCTATGGTGGAATGAAAAATGGCCCGCCAAGGTCTGCATAAAATCGAAAGACCAGCCCTAGACTTGCTACATCCAAGCAGTGCGCCTTGTACTTTAGCTATTTAAAGGGTTAGGCACATGAAGACTCCGGTACCGTGGAAGCAGCGGTGCTTTGACGACTTCGTCGTGATACCGGTCACTTTTGATGACGACGAGCCTGAAGTGCTGGTGAGCCGATTCGATATGTGGGGTACGAACTTCGTACTTATGTGTCCGAGTCGGAGCTGCCCCAGATAGAGTCGCGGCAAACGCGCATCTTCTATGTTAGTGTAGCAATTGATTCACGATAGTAATGAAACCAATGTGGTATGGTCTCGACAGCACCCTCCGACAAAGACTAGACTGTGATGCCAGGCTAATACGTCCAAATAGATTCTCGGTCTTAACGGTCGGGAGGAGTCGTGCTACCGAAAGCAGGCCTGATCGTTAACATTAGGCTCGATAACCTCACACCCCATAGGAAGACGGAACCAGTGGCACAAGGAATAAATATATTCGTATTACACCCTGATTGGCAAGAGGAAAGGGGGTGGGTGGGTAAGACGGTACGTTCCAACCCATTCTAGTCAATTCGAGTAAGGTAACACGCAGGGAAGCCTCTATGAGAGTCGGCTGCCTGGGTATCTCAACTATGTATAGCGATGGGAAGACGAAGCGAACGCGGGTGACGGACGGCTGACTGGGAGTATTATCCGTGAAAGATCGCGGGGTCCTCGATTCGCTGTAGAGATCGTGCCACCTCTCAGGACAATCAACGGCTTTCGACGTAAGGAATGCATATTATCGTGGTTCCAGGGTCTTTTAAGCATGACGAGATTTGACTGATTCGTTATCTACACGCGCTTATCACTTTTCTTGGAAATACGTCAGGTACCACGGATTCTTGATGCAATGGTTCCCTCTTACGACATACTAATATACGTTATCTGGCAATGCTTCCGCGCTGGTCTGATCTCCGGGGCGCAGTTATTGGAGTAGATAATTCGGCCCTGCCTTACAACGATAGACCCCAGTAGGTGAGAGAGTTTCACTTCTTCGTCCATTGGCTACGTTGTGGCTTCACCACCAGGTGCGAGGCCAACGGTCTAACCACACGAAACGACAGTAGACAGACTGGGACAAGGGCTCACTGGGGGGACTAGAGCTAAGCTACAAGCGAATAACTCACTTCGTCCGCTGTTGCGACGGGAATTTATAGTTTAGGTCGTAGGCGCTGCGACGGTTCAGACTCAGAGTGCGTGGCGGTACCACGGATGTTCTTCACTACGGTTATAGGTAAGGTTATACCACGATGGGCATCCGCCCCCCTACAATACTTTGACGGACTACTGTGCGATATTTGCCAACGGATTCTGTAGATGCGTTAGAGGGCGTCGGTCGGACCCACCCATGTGTGGATGTCGGTACTGAATTTGGTGGCCTATCGAAAATGATTGGTTTGGTAGTCTTGCACCCACTATATACAATGTGTCAACTGGTACAAACAAATCATGATGTGTTTGCCTTTGCCTGGTCATTGCCAACCGTTTCTATCACACAGACCTACTATTGCCTACAGGTTAGCTGTTTCACAATTGGTCTTACCCACAGTAGTCAATATAAATACCCATGATTGCCCACTTATGTCCTAACCGCGCGAATTGGCAGAAAAAGTCCTGGCCTGGAGGTAGAGGGTTAGCTGCAACGCAGTGTCGAACCATCTCGAAATGCGTCGTGCCGCTCCTCTAAGCTATGCGACAAATCCTCAAGATACAACTGAGGGGTTCCTGACGTTTCTGTACGCGTCCGGAGTATACAGTATTATAGCCTAAAAGAATCTCCCGTGATGGCTAACAGTAAAGAGCGAGCGAGATCTATAAGAATATACGCGCTTCGAATTAGTGGTGCGCTTGTCCGCCCCACTCTCAGGTTCTTGACGGCCGAACGCTTTATAACTCCAGACCATCGACCGCCGATGCCTAACCGATCCTTAACTCCATACCCTCCGCCTGACGTTGGCAGATTGTTATATATTGTCTTCCTCGATCAGAACCATAGTACGTACCGCACGGTAGCGTCCTGACTGCGCTGGAGCTTCGGAATACGTTGGGATGCTGCCCAGGTCATCTCCCCTTTTCCCGTGGCTTCCGAAGTTTAGCGTTGAGCAGAAACTCTTTTAGCGCCATTCAGTAGTTGGAGTTCCCGTCCCAAACTATAGAACCTGGTACATCTCCCGTGGGCGGAAGGGCAGATTAAAGAGCGTCAGTGTAATCGTAATTGTTACAGTGCGAGAATGAATTGGCAGCAGATCACTACGTACAGGCACTTTAAAGCGGATCTTGCCCAGTTCGAGGTATGGCATTCCTCTAGGGCGTACCACCAGTGATCCGGTTACCGGACGAGCTCCATAATTTGGGAGTTGTTGGAATGCATAAGGCGCCCAGCGAACCCAAGTCAGGTCTATTAGGGCGCCATATGATGTTGCTATCTCCCGTGAGACCGTCGGAATATGTTAACAGAAGGGGCGGTAAGTGGCACACCGAGAAAAGAGTACCCCGGTATGACTCCATACGTTGGTCCAAAGCGCATCTGCGAAAGGAAGCATACATCCAATCCTCCCGATTAGTACAACTATTACCTTCCTGTAGCAAATCTATACTTAAGTGCGAACCGATGTCCTAATGACTGTCCCTACATGCATGATCGGGTAACGTGCGTCCCCTAAACTAATAACAAAACGGGCGTAGAATGGGCGTAGGTTATAAGGTGTGCTAGGAATAGTAGTGGTGCAGCATCGACTTAGCCTCCGATTGTGCCGTACTTATACTTTTATACAGCTGTCCCATCCCTGGGGACTGCCTTAGCCGCAGGAGGGGGCTGGAATCCGCGACCCATATCAATAGAGTCAGCGTTCCATATTGGTTATCACATCATCCTCCAACTGTATATGTGAAATGGTTTTATGCTATAGCCGTTAGTCGCGAGCGGCCCATTTATCATAGTTAACAGCCCTCCGTGGCGTCCGGCAAGGCACCGGGTCCAGCTGGTTCCTACGGGAGGACTAAATACCGGTCTTGCAGCGTGTTGTTCTTCTCCCTTCCTGTCATCAGATACAGTTGCCTTTTGAATTACACGTCTATTTGTGAATTGCTAGATGGATAAAACACCATGCTGGACTGTTCCTTAAGAAAACGGGTTGCAGTCATTATCTGAACCCATAAGATGAATAAGGGCCACCTGCAGGAGCCACGGCCTGTCTGTAGATTTCGGATTCGTCCCGCGACGGTTAGGTTTCGGTATATAAATAGCCGTATTATAACGTGTTACCATACACATCGTGTGAGATGGTCGCTTCGCAGTAAAGATCTATTAGTTCAATGCCGCCGACCTGGAGAGCGAGAAATCGCTGTTATGTCGTTCCTATGGGAGGGACGAGATGCCAGCTCGCCGAGATAACCGTATTTACCACATCCTTAGGAACTCCGGCGCGTTAAAAGCCGCCAAGCTCTAGTTCCGGCTGGCAGGCGCTGCGTAAAGTTGGGTACTTTAAAAGCCATGTCGGTGCCGAGGACAGCCAAGTAAATGTTTCAGCCGAAGTGTTGAGGCATTCGCATACTCAACACTAGCATTCTTCACCCTAGGTGGGTCTCGGGCAACGTCGTGGGGAACCTACGGTACTGGGCGCAGTTCGCCCTAGTTGGTGCGACCGGTTCTTACCGATTCATCGAAGATAGAACGAGTCATTCCCGAACAAGCATTAGCGTTCAGGCGGCTCAAAGTCAAACAGCCCATTACCCAAGCGCGACCATGCGGCCTGGCACGTTACCTATAACACCAGATGCCGGCTCTAAGGTGCTCCTGCAAGAGTGCTAGCCCCGGCACAGGCGGTAAAAGGGATAGTCGTCTCACCATATAACTATCCTACATATATTGAAAGAGTCGGTGGGATCACTGGTAGCAGCCGCCTCAACGCGTTAAGCGGAGGGGATAAGAGCAGCCCCGATACTTACCTCTGCAA', 3) as k(kmer);

insert into large_table (kmer)
select k.kmer
from generate_kmers('ACATGAAAGCCGACTGTGTCCCCGATGGGGCGTTAATCCCCACGACAAGGCGGTAAAAAGATCACTGACACCGCTGTTCTTCGAAAGAACCGAGGTGGTCAGGCGGACGTGGGGGCCCGTTCTGGGCCGGCAGAGTTATAGAACCGCTACGCAGACTCTCAAGCCTCAGCATTAGCCCTCAAACGACCTCAGACGCTCTTGCGCCAGCGATTACTCTAGTGCTCTGAAGGTACATCTTTGACAAGGAGATCGTCTGCTAGCGGACTATTAGAACTGCCGTCTGGCAAAGTCCGCAACTGGGAATACACGGTTCCCTAGTTGCAGTGCCTTGTAGAGAGATCGATCTAAATCCCTATCTCCGCATTCGGACTCCCAGCGAGTCCAACGGGTGTGTGATCAGTAATATCGGCTTAAGCAGGGAGCAATAAGGTATTGAGCTATTACCCCTCTTTCCAGGGACGCCGTACCCGAACATCCGTCACAAAGGGACTCTGCGATGAGAGGGCCTATATATACCCTTGCAACGGACCAACTACGCTAAGGAGAATACAAACCGGGAGTGGAATTCGCCGGTAGGAAGAATGTGAGGTAGTTCTGGAACTGCCCTAACACGGGATATTGTCTGCGATAGACAGGGTCATCCGGAGGAATGACATACACTATTTTGTGCTTTCCAAGTAGGAATCCATATGCGTCATCATTTTACGTTACTGTGATACTCACAGACCGTTGTACAGTAGCTACCCAATAGTCAAGCCAGTCTAAAGTAGACAAAGCGAGTGCCATAACACGTGGGCCATTCTAACGAACTCGTCGGCAGGTATGCTTCCGTTTGCCTATCATCCCAGTAGCGGGCCGCGGTCTGTCCATTCGGGGAAATCAGGCATTCTGAAAATCATCGACAGATGCGTCCGTAATAGTGCGAGGATGGCTCAATCACTCTAGTTAACACTGACATTAACAACCTATGGTGGAATGAAAAATGGCCCGCCAAGGTCTGCATAAAATCGAAAGACCAGCCCTAGACTTGCTACATCCAAGCAGTGCGCCTTGTACTTTAGCTATTTAAAGGGTTAGGCACATGAAGACTCCGGTACCGTGGAAGCAGCGGTGCTTTGACGACTTCGTCGTGATACCGGTCACTTTTGATGACGACGAGCCTGAAGTGCTGGTGAGCCGATTCGATATGTGGGGTACGAACTTCGTACTTATGTGTCCGAGTCGGAGCTGCCCCAGATAGAGTCGCGGCAAACGCGCATCTTCTATGTTAGTGTAGCAATTGATTCACGATAGTAATGAAACCAATGTGGTATGGTCTCGACAGCACCCTCCGACAAAGACTAGACTGTGATGCCAGGCTAATACGTCCAAATAGATTCTCGGTCTTAACGGTCGGGAGGAGTCGTGCTACCGAAAGCAGGCCTGATCGTTAACATTAGGCTCGATAACCTCACACCCCATAGGAAGACGGAACCAGTGGCACAAGGAATAAATATATTCGTATTACACCCTGATTGGCAAGAGGAAAGGGGGTGGGTGGGTAAGACGGTACGTTCCAACCCATTCTAGTCAATTCGAGTAAGGTAACACGCAGGGAAGCCTCTATGAGAGTCGGCTGCCTGGGTATCTCAACTATGTATAGCGATGGGAAGACGAAGCGAACGCGGGTGACGGACGGCTGACTGGGAGTATTATCCGTGAAAGATCGCGGGGTCCTCGATTCGCTGTAGAGATCGTGCCACCTCTCAGGACAATCAACGGCTTTCGACGTAAGGAATGCATATTATCGTGGTTCCAGGGTCTTTTAAGCATGACGAGATTTGACTGATTCGTTATCTACACGCGCTTATCACTTTTCTTGGAAATACGTCAGGTACCACGGATTCTTGATGCAATGGTTCCCTCTTACGACATACTAATATACGTTATCTGGCAATGCTTCCGCGCTGGTCTGATCTCCGGGGCGCAGTTATTGGAGTAGATAATTCGGCCCTGCCTTACAACGATAGACCCCAGTAGGTGAGAGAGTTTCACTTCTTCGTCCATTGGCTACGTTGTGGCTTCACCACCAGGTGCGAGGCCAACGGTCTAACCACACGAAACGACAGTAGACAGACTGGGACAAGGGCTCACTGGGGGGACTAGAGCTAAGCTACAAGCGAATAACTCACTTCGTCCGCTGTTGCGACGGGAATTTATAGTTTAGGTCGTAGGCGCTGCGACGGTTCAGACTCAGAGTGCGTGGCGGTACCACGGATGTTCTTCACTACGGTTATAGGTAAGGTTATACCACGATGGGCATCCGCCCCCCTACAATACTTTGACGGACTACTGTGCGATATTTGCCAACGGATTCTGTAGATGCGTTAGAGGGCGTCGGTCGGACCCACCCATGTGTGGATGTCGGTACTGAATTTGGTGGCCTATCGAAAATGATTGGTTTGGTAGTCTTGCACCCACTATATACAATGTGTCAACTGGTACAAACAAATCATGATGTGTTTGCCTTTGCCTGGTCATTGCCAACCGTTTCTATCACACAGACCTACTATTGCCTACAGGTTAGCTGTTTCACAATTGGTCTTACCCACAGTAGTCAATATAAATACCCATGATTGCCCACTTATGTCCTAACCGCGCGAATTGGCAGAAAAAGTCCTGGCCTGGAGGTAGAGGGTTAGCTGCAACGCAGTGTCGAACCATCTCGAAATGCGTCGTGCCGCTCCTCTAAGCTATGCGACAAATCCTCAAGATACAACTGAGGGGTTCCTGACGTTTCTGTACGCGTCCGGAGTATACAGTATTATAGCCTAAAAGAATCTCCCGTGATGGCTAACAGTAAAGAGCGAGCGAGATCTATAAGAATATACGCGCTTCGAATTAGTGGTGCGCTTGTCCGCCCCACTCTCAGGTTCTTGACGGCCGAACGCTTTATAACTCCAGACCATCGACCGCCGATGCCTAACCGATCCTTAACTCCATACCCTCCGCCTGACGTTGGCAGATTGTTATATATTGTCTTCCTCGATCAGAACCATAGTACGTACCGCACGGTAGCGTCCTGACTGCGCTGGAGCTTCGGAATACGTTGGGATGCTGCCCAGGTCATCTCCCCTTTTCCCGTGGCTTCCGAAGTTTAGCGTTGAGCAGAAACTCTTTTAGCGCCATTCAGTAGTTGGAGTTCCCGTCCCAAACTATAGAACCTGGTACATCTCCCGTGGGCGGAAGGGCAGATTAAAGAGCGTCAGTGTAATCGTAATTGTTACAGTGCGAGAATGAATTGGCAGCAGATCACTACGTACAGGCACTTTAAAGCGGATCTTGCCCAGTTCGAGGTATGGCATTCCTCTAGGGCGTACCACCAGTGATCCGGTTACCGGACGAGCTCCATAATTTGGGAGTTGTTGGAATGCATAAGGCGCCCAGCGAACCCAAGTCAGGTCTATTAGGGCGCCATATGATGTTGCTATCTCCCGTGAGACCGTCGGAATATGTTAACAGAAGGGGCGGTAAGTGGCACACCGAGAAAAGAGTACCCCGGTATGACTCCATACGTTGGTCCAAAGCGCATCTGCGAAAGGAAGCATACATCCAATCCTCCCGATTAGTACAACTATTACCTTCCTGTAGCAAATCTATACTTAAGTGCGAACCGATGTCCTAATGACTGTCCCTACATGCATGATCGGGTAACGTGCGTCCCCTAAACTAATAACAAAACGGGCGTAGAATGGGCGTAGGTTATAAGGTGTGCTAGGAATAGTAGTGGTGCAGCATCGACTTAGCCTCCGATTGTGCCGTACTTATACTTTTATACAGCTGTCCCATCCCTGGGGACTGCCTTAGCCGCAGGAGGGGGCTGGAATCCGCGACCCATATCAATAGAGTCAGCGTTCCATATTGGTTATCACATCATCCTCCAACTGTATATGTGAAATGGTTTTATGCTATAGCCGTTAGTCGCGAGCGGCCCATTTATCATAGTTAACAGCCCTCCGTGGCGTCCGGCAAGGCACCGGGTCCAGCTGGTTCCTACGGGAGGACTAAATACCGGTCTTGCAGCGTGTTGTTCTTCTCCCTTCCTGTCATCAGATACAGTTGCCTTTTGAATTACACGTCTATTTGTGAATTGCTAGATGGATAAAACACCATGCTGGACTGTTCCTTAAGAAAACGGGTTGCAGTCATTATCTGAACCCATAAGATGAATAAGGGCCACCTGCAGGAGCCACGGCCTGTCTGTAGATTTCGGATTCGTCCCGCGACGGTTAGGTTTCGGTATATAAATAGCCGTATTATAACGTGTTACCATACACATCGTGTGAGATGGTCGCTTCGCAGTAAAGATCTATTAGTTCAATGCCGCCGACCTGGAGAGCGAGAAATCGCTGTTATGTCGTTCCTATGGGAGGGACGAGATGCCAGCTCGCCGAGATAACCGTATTTACCACATCCTTAGGAACTCCGGCGCGTTAAAAGCCGCCAAGCTCTAGTTCCGGCTGGCAGGCGCTGCGTAAAGTTGGGTACTTTAAAAGCCATGTCGGTGCCGAGGACAGCCAAGTAAATGTTTCAGCCGAAGTGTTGAGGCATTCGCATACTCAACACTAGCATTCTTCACCCTAGGTGGGTCTCGGGCAACGTCGTGGGGAACCTACGGTACTGGGCGCAGTTCGCCCTAGTTGGTGCGACCGGTTCTTACCGATTCATCGAAGATAGAACGAGTCATTCCCGAACAAGCATTAGCGTTCAGGCGGCTCAAAGTCAAACAGCCCATTACCCAAGCGCGACCATGCGGCCTGGCACGTTACCTATAACACCAGATGCCGGCTCTAAGGTGCTCCTGCAAGAGTGCTAGCCCCGGCACAGGCGGTAAAAGGGATAGTCGTCTCACCATATAACTATCCTACATATATTGAAAGAGTCGGTGGGATCACTGGTAGCAGCCGCCTCAACGCGTTAAGCGGAGGGGATAAGAGCAGCCCCGATACTTACCTCTGCAA', 5) as k(kmer);

insert into large_table (kmer)
select k.kmer
from generate_kmers('ACATGAAAGCCGACTGTGTCCCCGATGGGGCGTTAATCCCCACGACAAGGCGGTAAAAAGATCACTGACACCGCTGTTCTTCGAAAGAACCGAGGTGGTCAGGCGGACGTGGGGGCCCGTTCTGGGCCGGCAGAGTTATAGAACCGCTACGCAGACTCTCAAGCCTCAGCATTAGCCCTCAAACGACCTCAGACGCTCTTGCGCCAGCGATTACTCTAGTGCTCTGAAGGTACATCTTTGACAAGGAGATCGTCTGCTAGCGGACTATTAGAACTGCCGTCTGGCAAAGTCCGCAACTGGGAATACACGGTTCCCTAGTTGCAGTGCCTTGTAGAGAGATCGATCTAAATCCCTATCTCCGCATTCGGACTCCCAGCGAGTCCAACGGGTGTGTGATCAGTAATATCGGCTTAAGCAGGGAGCAATAAGGTATTGAGCTATTACCCCTCTTTCCAGGGACGCCGTACCCGAACATCCGTCACAAAGGGACTCTGCGATGAGAGGGCCTATATATACCCTTGCAACGGACCAACTACGCTAAGGAGAATACAAACCGGGAGTGGAATTCGCCGGTAGGAAGAATGTGAGGTAGTTCTGGAACTGCCCTAACACGGGATATTGTCTGCGATAGACAGGGTCATCCGGAGGAATGACATACACTATTTTGTGCTTTCCAAGTAGGAATCCATATGCGTCATCATTTTACGTTACTGTGATACTCACAGACCGTTGTACAGTAGCTACCCAATAGTCAAGCCAGTCTAAAGTAGACAAAGCGAGTGCCATAACACGTGGGCCATTCTAACGAACTCGTCGGCAGGTATGCTTCCGTTTGCCTATCATCCCAGTAGCGGGCCGCGGTCTGTCCATTCGGGGAAATCAGGCATTCTGAAAATCATCGACAGATGCGTCCGTAATAGTGCGAGGATGGCTCAATCACTCTAGTTAACACTGACATTAACAACCTATGGTGGAATGAAAAATGGCCCGCCAAGGTCTGCATAAAATCGAAAGACCAGCCCTAGACTTGCTACATCCAAGCAGTGCGCCTTGTACTTTAGCTATTTAAAGGGTTAGGCACATGAAGACTCCGGTACCGTGGAAGCAGCGGTGCTTTGACGACTTCGTCGTGATACCGGTCACTTTTGATGACGACGAGCCTGAAGTGCTGGTGAGCCGATTCGATATGTGGGGTACGAACTTCGTACTTATGTGTCCGAGTCGGAGCTGCCCCAGATAGAGTCGCGGCAAACGCGCATCTTCTATGTTAGTGTAGCAATTGATTCACGATAGTAATGAAACCAATGTGGTATGGTCTCGACAGCACCCTCCGACAAAGACTAGACTGTGATGCCAGGCTAATACGTCCAAATAGATTCTCGGTCTTAACGGTCGGGAGGAGTCGTGCTACCGAAAGCAGGCCTGATCGTTAACATTAGGCTCGATAACCTCACACCCCATAGGAAGACGGAACCAGTGGCACAAGGAATAAATATATTCGTATTACACCCTGATTGGCAAGAGGAAAGGGGGTGGGTGGGTAAGACGGTACGTTCCAACCCATTCTAGTCAATTCGAGTAAGGTAACACGCAGGGAAGCCTCTATGAGAGTCGGCTGCCTGGGTATCTCAACTATGTATAGCGATGGGAAGACGAAGCGAACGCGGGTGACGGACGGCTGACTGGGAGTATTATCCGTGAAAGATCGCGGGGTCCTCGATTCGCTGTAGAGATCGTGCCACCTCTCAGGACAATCAACGGCTTTCGACGTAAGGAATGCATATTATCGTGGTTCCAGGGTCTTTTAAGCATGACGAGATTTGACTGATTCGTTATCTACACGCGCTTATCACTTTTCTTGGAAATACGTCAGGTACCACGGATTCTTGATGCAATGGTTCCCTCTTACGACATACTAATATACGTTATCTGGCAATGCTTCCGCGCTGGTCTGATCTCCGGGGCGCAGTTATTGGAGTAGATAATTCGGCCCTGCCTTACAACGATAGACCCCAGTAGGTGAGAGAGTTTCACTTCTTCGTCCATTGGCTACGTTGTGGCTTCACCACCAGGTGCGAGGCCAACGGTCTAACCACACGAAACGACAGTAGACAGACTGGGACAAGGGCTCACTGGGGGGACTAGAGCTAAGCTACAAGCGAATAACTCACTTCGTCCGCTGTTGCGACGGGAATTTATAGTTTAGGTCGTAGGCGCTGCGACGGTTCAGACTCAGAGTGCGTGGCGGTACCACGGATGTTCTTCACTACGGTTATAGGTAAGGTTATACCACGATGGGCATCCGCCCCCCTACAATACTTTGACGGACTACTGTGCGATATTTGCCAACGGATTCTGTAGATGCGTTAGAGGGCGTCGGTCGGACCCACCCATGTGTGGATGTCGGTACTGAATTTGGTGGCCTATCGAAAATGATTGGTTTGGTAGTCTTGCACCCACTATATACAATGTGTCAACTGGTACAAACAAATCATGATGTGTTTGCCTTTGCCTGGTCATTGCCAACCGTTTCTATCACACAGACCTACTATTGCCTACAGGTTAGCTGTTTCACAATTGGTCTTACCCACAGTAGTCAATATAAATACCCATGATTGCCCACTTATGTCCTAACCGCGCGAATTGGCAGAAAAAGTCCTGGCCTGGAGGTAGAGGGTTAGCTGCAACGCAGTGTCGAACCATCTCGAAATGCGTCGTGCCGCTCCTCTAAGCTATGCGACAAATCCTCAAGATACAACTGAGGGGTTCCTGACGTTTCTGTACGCGTCCGGAGTATACAGTATTATAGCCTAAAAGAATCTCCCGTGATGGCTAACAGTAAAGAGCGAGCGAGATCTATAAGAATATACGCGCTTCGAATTAGTGGTGCGCTTGTCCGCCCCACTCTCAGGTTCTTGACGGCCGAACGCTTTATAACTCCAGACCATCGACCGCCGATGCCTAACCGATCCTTAACTCCATACCCTCCGCCTGACGTTGGCAGATTGTTATATATTGTCTTCCTCGATCAGAACCATAGTACGTACCGCACGGTAGCGTCCTGACTGCGCTGGAGCTTCGGAATACGTTGGGATGCTGCCCAGGTCATCTCCCCTTTTCCCGTGGCTTCCGAAGTTTAGCGTTGAGCAGAAACTCTTTTAGCGCCATTCAGTAGTTGGAGTTCCCGTCCCAAACTATAGAACCTGGTACATCTCCCGTGGGCGGAAGGGCAGATTAAAGAGCGTCAGTGTAATCGTAATTGTTACAGTGCGAGAATGAATTGGCAGCAGATCACTACGTACAGGCACTTTAAAGCGGATCTTGCCCAGTTCGAGGTATGGCATTCCTCTAGGGCGTACCACCAGTGATCCGGTTACCGGACGAGCTCCATAATTTGGGAGTTGTTGGAATGCATAAGGCGCCCAGCGAACCCAAGTCAGGTCTATTAGGGCGCCATATGATGTTGCTATCTCCCGTGAGACCGTCGGAATATGTTAACAGAAGGGGCGGTAAGTGGCACACCGAGAAAAGAGTACCCCGGTATGACTCCATACGTTGGTCCAAAGCGCATCTGCGAAAGGAAGCATACATCCAATCCTCCCGATTAGTACAACTATTACCTTCCTGTAGCAAATCTATACTTAAGTGCGAACCGATGTCCTAATGACTGTCCCTACATGCATGATCGGGTAACGTGCGTCCCCTAAACTAATAACAAAACGGGCGTAGAATGGGCGTAGGTTATAAGGTGTGCTAGGAATAGTAGTGGTGCAGCATCGACTTAGCCTCCGATTGTGCCGTACTTATACTTTTATACAGCTGTCCCATCCCTGGGGACTGCCTTAGCCGCAGGAGGGGGCTGGAATCCGCGACCCATATCAATAGAGTCAGCGTTCCATATTGGTTATCACATCATCCTCCAACTGTATATGTGAAATGGTTTTATGCTATAGCCGTTAGTCGCGAGCGGCCCATTTATCATAGTTAACAGCCCTCCGTGGCGTCCGGCAAGGCACCGGGTCCAGCTGGTTCCTACGGGAGGACTAAATACCGGTCTTGCAGCGTGTTGTTCTTCTCCCTTCCTGTCATCAGATACAGTTGCCTTTTGAATTACACGTCTATTTGTGAATTGCTAGATGGATAAAACACCATGCTGGACTGTTCCTTAAGAAAACGGGTTGCAGTCATTATCTGAACCCATAAGATGAATAAGGGCCACCTGCAGGAGCCACGGCCTGTCTGTAGATTTCGGATTCGTCCCGCGACGGTTAGGTTTCGGTATATAAATAGCCGTATTATAACGTGTTACCATACACATCGTGTGAGATGGTCGCTTCGCAGTAAAGATCTATTAGTTCAATGCCGCCGACCTGGAGAGCGAGAAATCGCTGTTATGTCGTTCCTATGGGAGGGACGAGATGCCAGCTCGCCGAGATAACCGTATTTACCACATCCTTAGGAACTCCGGCGCGTTAAAAGCCGCCAAGCTCTAGTTCCGGCTGGCAGGCGCTGCGTAAAGTTGGGTACTTTAAAAGCCATGTCGGTGCCGAGGACAGCCAAGTAAATGTTTCAGCCGAAGTGTTGAGGCATTCGCATACTCAACACTAGCATTCTTCACCCTAGGTGGGTCTCGGGCAACGTCGTGGGGAACCTACGGTACTGGGCGCAGTTCGCCCTAGTTGGTGCGACCGGTTCTTACCGATTCATCGAAGATAGAACGAGTCATTCCCGAACAAGCATTAGCGTTCAGGCGGCTCAAAGTCAAACAGCCCATTACCCAAGCGCGACCATGCGGCCTGGCACGTTACCTATAACACCAGATGCCGGCTCTAAGGTGCTCCTGCAAGAGTGCTAGCCCCGGCACAGGCGGTAAAAGGGATAGTCGTCTCACCATATAACTATCCTACATATATTGAAAGAGTCGGTGGGATCACTGGTAGCAGCCGCCTCAACGCGTTAAGCGGAGGGGATAAGAGCAGCCCCGATACTTACCTCTGCAA', 9) as k(kmer);

insert into large_table (kmer)
select k.kmer
from generate_kmers('CCGGGCACTAGGGGGCACGGCCCTTAGATAGTGCGAATAGTGCCTATGCATAAACACATCAGAAGTCAGATTTGTACTTACCGGCCCGTTTGATCACATCACTTAGAATAAATAAAAACTGAGTACGTAGCGACTAACGAACTGTTATGAATTCTAAGGCCCAATCCCTGAGAATAGCGTAAGGATCCAAAACGTATGCCACAGACTGGTAATTCACAACCTTAGCTTGCAGGGGATGGGTTGATCGAAAGAGGAGCATATCGACTATGGTCCCAGGGGTCTCCCCGTCCCCATATTCGCGCTCATGGATAGTAGTCACGTCGTTCAGAGCATACACGGGTGCAATGATTCTTATATGGTGCCGATATAATAATACGGGGCCACCTCCGTTATCAATAACATTGATCTCAGTAGTGAGTGTAACCTCAATACATTCGCACGTGATAGTGTGGCATAAAATAACCATCGACAATCAAAACTATTGAGATCAATTGTCGAGGAGATTTCTTCATCTGAAGTAGTCACAGGTAGTATGGCTTCGTGAGACCCTGCACATTCGGCAGTCCTCGCGGGGAAAGACCACTCCGATGTGTTCTGATGGACTAAGGCTCTGCCAATCCTTCAACGACTCGCCAGTTTCATTATTCTATGACGAACTTGCACACGGGATCGTCAATAAATAGTTATGGTACGTCTGACACTTGCTACGAATCTACTAACAACGCTCACGTTTATGTCCAATACAGAAACATACCGGTTTGCTCCACGGTAGCGACGAACGAAAAGCGAGGCAGGGACGATTCCGGTTGGCAATTGCAATACTCTCCAAACTTCCACGTTAAAACTAGTTGTATAAGCGAACTCTAATGCGGCGTGCAAGGGGCGGAAACAGTGCGCCGTCTGACCTGGATTTATCAAAGGAACTTGCAGGTCTGGTATGTGTTGTTCAATCACGGAGTTATCGAAATAGGTCACTTACTGTACCTTGTCTCGCACCTCCACTACCGTCCGGAGTAAAGCACCAGTGCACGATGGTTAGTATCCGTAGCTACAAGCGCTAGTTTTTCCTCCAAGTTATTGGGGGAAGGAAGTCCGCCCGTTGATATTCCAAGGTCCTATCTACGAAGTGAAACTAGGTCTGCCAAATTAAGGGGACCTATTCCCTTCATCTATGTGACGCCTCCGCTGTATGGGAATTAACATAGGTGCAGCACCCGGACGAGCGTTTCTGGCCTCACCGTATCCGAACCCAGGGTAGGGTATCGTACCACGAAAAGAACAGCCGCTAATTGGCTGAGAGTATGCAATAGATATGAAATGTGACCCAAATATCGTCCGTCCTTGACAAAGAAGTAAAGGGCTACTGATCGTCTTTAATCGAACCGCTCGTCGGGTGTAATCGTTAATGGCGTAGACCGGCCCTTGTTGTATCATTGTCACGGCGTAATTCGACTACGTCAGTAGAAGGAATGAGTGGTCGGAGTCAAGGTCACTTATTGTTTCACGCCGGTGATTATAGAGAGATTAAGACATCCATAGCAATTAGCAATTTCCGGTCGGATTCCGAGACGGCTCGCAACTGAAACCTCGCCGAGCGAGTGAGGAGCCAAGCGCAGCCTGGGGCAATTTTCAACGCTCTGTTGCTGACTAACTTATATTATTTTAGTGACAAAACTACATTACGGTACGCAGACATCCCCCGAGAATAGTTTAGACTACAAGCGCTGTAGCGTGCTTGCAGAGCGCATACCGAATTTGACCACAATTGAACGTCGCGGATCCGTACGAGAAGAAATCGCAACCTAGGTCGGGAAGCCGTACGGCACTCATTGATCTTCTCTACAGACAAACGCCGCCCTCTGCAAACTGAGGGCCGAGGCATTGACCCGGGGGTAGTCAAGGATAGATCAATGAGTATAGACCGCGGTTACTACATACGACCGACGCATTTGATTGTCAGCGTGTAGAAGTCTACTAAGTTGACGGGCACGGCGTCCTGGGTCATAGAAGTTTCTGCAACGGAATTCGACAGCAGCGTATGTAGTCAACTTACTGGATAGCAAATACGTTCTGCCGTCTTGTTGCTAGGGGTACGTCCGGGGCAGATAGGAATGTCTGAGCCGACAACACATTCCCTAGCTACCTCGGGCAGGACACCCTTTGGAGGTGGCCGTTGGTCCTTCACGGAACGGTATCCTCTTCCTAAACCCCGCCTATGTATATCGATCACATCGCCTGTGACGCGACGTAGGATAAGACTCCCGTTCGGGTACAGTCTCCACCGTGGCGCCAGTAGCATCAACTTCGGCGGCGAGCCTAGGCTCGAACTAGGCCAGGTGACCGTAAATCTCGTCATAAGCCGCACTCTGAAGGAGCTAACTGCGAACTTGTTTCTTACCCAGCGGTACGAAAATCAAATGTACTGGGACGCCGTGTACTCCCGCGGTGACAGCTTTGGGGGAGTGCGCCCCAATATTGCACGCCTAGCAGACACACAGTCCTTTTTGTAATTGCCGTATTAGCCTTGCTGGCACAGCACGGCGCTGTGATTACACCACGGTCCCGGATAGACCATCTCGCGAGCGAGCAGCCAACCGATTATTGCCCGAAGCGGCGATGTTCAGGGAACGTGGGTCTACATTAGCAATTGTCTACTCGTTCCGTTCCCCGCCCATCACCTAGTGTGCTGCGAGGAGGGCGGGGTGTACGGGTGTTCGGCCTCCGATCACGAGTTTTGGAGGGATATGCCGTAGCCTAGTTACCATCGGTGCGGGCTGATACGTTACTGGATGTTATAGAGCTGTCGAATGTTGTGATCCTTACGACACCACCCGGTTTATCAGGTACATATAATTAGAGGTTGAGCGTATTCCTCTGTAAGCTCCTGTGGGCGGTCACTTAATTAACAGGACTTTCCATTCCAACGCGTGACGCTAAACTGAAAGGGCGGCAGTAGTCGTCTTCACAGGTCCTTCGGAGGATCTTTCGTCGCGGATGCGCGGCTGCCTAACGCGCCGGGGCTTCGGCCTATGGCAATTGCTGGGAGTGCATACCCGAGGCCACACACCCGCCTGGTTGTTATTACCGCGTAAGTCGAAGCCCATCCACAGAATCCGTGGGCCCTCCACGTCTAACCGGTGTTCTGTCTGATGAGATGATTATGCATCCACGGACACTGATGTGATCTAACACCGACTCGCCGGTCTTGTCTGGTGGTGCCGAAAACACTCGCATTTTCGTCAATAACACCAGGATATGAACGCCCGAGGCTGGAGGACAAACCTCTAGGGCGGCGCGCTTAGGATAGGCGAGCACTCTGTAGCCTAATCAGATGATTCTCAGCGCAGGGCGTTCACTCTAGCTTCGCCCAACCGCTTGGTAACGGTGTGCACCTGGAGCACTTCACAGCACCGGGCCAGGAGGTATCTGAGAATTACATCCGGAAAGTAGCCGAGCACATGTTACCTTAGCTACCCCCTAGCTTCCGTTATTGGAATAGGTTCATTACAACACCCCGTGACCAACCCTTAATTCTCTGGACCCACTGAAAGGGATCGAACTCCCCTATTCTGCCCCGGTCCGGAGGACCCAACACTGCTAGGGGGGATAGCAATCGGTACCCAAGATATCATCAACCTGCAAATAGAACCGACTTCCAATTCATTACGTGATTGAAACGCCGACCGTCCAATAGAAATTGTATTACAATCACCAGTATCTAGTTGCCTGTAAGAATTACAGTCTTGCCCCGGGATCCGGGAAAGCATCGGGTGAATCCTCGACGGCACCGAGTGACGACCATAAGGAGGGTGTGAGGATTAGCATATGTGGTGGTTCCATAGATCACAGCCGAACTGATGTGTCATAACGAGTAACGCAACAGATGCGACGTTGGTGCTGGGGCCTCTCTTACAATTGGAGAGCACTGGCGAGGAGGTAAAGTGTCTGTCATATTCACGCATGCGATATACAGAGATGGGCGGATTGGAAAACACACGCTTACATAAGCAAATTCGAGATTAGAAGGTCAGAGAAGTTGCGAATTACTTTGCGGAGACGAATTGGGCTCATAGCGCCCGTCGTCCATATTTACTAAGATCGACCCGAGAACATATCTTCCCACGCCCAGGTGCCGAGGTTTGCTCAAACGGTATTAGAAAAAACCCCTAATTTTGGGTGTAGCTAACATATAAGCTGAGGGTACGGGATTAAGGCTAGTCCGCTTCGGCTCCATGGCTTATCCACGGCTTTGGCTGCAGTGGACGGCTTGGAGTGTGAACCTCCTAAGATAGGAAGGATCCATTGGCAGTCAATGCCTAACGTAGTTCTCGTTAGTGGTACGAGGCTCCAACCCAAGCGGCGGTGGTTCCGCGGTCCATTCGAGAGATGGATACTCAATAAAGGTAGAAAGCGGATGAAGACAATATTTGCAGACTAATCAACTACCCCCAACAGCTCTGCTGCTGATTGGCTCGCAAATCTAACATAAGTGGCAAGTGACCACTTCTCACCCGTAAAAGGGATGATTTATAAGATGGCACACATGAAGCTAATAGCAAGTCCCATAGCCCGCATGATGTAGCCGAGAAGAACCTCTTAGGGCTAGGGCTATGGCGTTCTATCGTTCTCTCACGAGACACTACCCGTGTGACTTACACTGCTAATCGCTTCTACCCGAATACTGCGAACTAACCCGGGGGCATAGTTTCCCCCTTGAGCCATCTTATCTTACTCATTGGAGAACCGCATAGCTGAGCGGCATGTCATTCCTCGGTCGACCCAGTAAGAGGAAAGCGGGAGAGATGGCCCACACCGAGTAGGAGTGGCGGGGTCAGGTCAGCCAAACACTACACCCTGGAAGCATGCGTTATCTGGACTTCTACGAGGAGCATAAAATTTGTCCATCTAGCTACCAGCGTGTATGGGAAGCTGCTGGCAAGTTGAGCGCGCATCCGCGATGGTCTTCTGATGTGGTCGCAATCCTGAACCGCCCCCGCTAT', 11) as k(kmer);

insert into large_table (kmer)
select k.kmer
from generate_kmers('CCGGGCACTAGGGGGCACGGCCCTTAGATAGTGCGAATAGTGCCTATGCATAAACACATCAGAAGTCAGATTTGTACTTACCGGCCCGTTTGATCACATCACTTAGAATAAATAAAAACTGAGTACGTAGCGACTAACGAACTGTTATGAATTCTAAGGCCCAATCCCTGAGAATAGCGTAAGGATCCAAAACGTATGCCACAGACTGGTAATTCACAACCTTAGCTTGCAGGGGATGGGTTGATCGAAAGAGGAGCATATCGACTATGGTCCCAGGGGTCTCCCCGTCCCCATATTCGCGCTCATGGATAGTAGTCACGTCGTTCAGAGCATACACGGGTGCAATGATTCTTATATGGTGCCGATATAATAATACGGGGCCACCTCCGTTATCAATAACATTGATCTCAGTAGTGAGTGTAACCTCAATACATTCGCACGTGATAGTGTGGCATAAAATAACCATCGACAATCAAAACTATTGAGATCAATTGTCGAGGAGATTTCTTCATCTGAAGTAGTCACAGGTAGTATGGCTTCGTGAGACCCTGCACATTCGGCAGTCCTCGCGGGGAAAGACCACTCCGATGTGTTCTGATGGACTAAGGCTCTGCCAATCCTTCAACGACTCGCCAGTTTCATTATTCTATGACGAACTTGCACACGGGATCGTCAATAAATAGTTATGGTACGTCTGACACTTGCTACGAATCTACTAACAACGCTCACGTTTATGTCCAATACAGAAACATACCGGTTTGCTCCACGGTAGCGACGAACGAAAAGCGAGGCAGGGACGATTCCGGTTGGCAATTGCAATACTCTCCAAACTTCCACGTTAAAACTAGTTGTATAAGCGAACTCTAATGCGGCGTGCAAGGGGCGGAAACAGTGCGCCGTCTGACCTGGATTTATCAAAGGAACTTGCAGGTCTGGTATGTGTTGTTCAATCACGGAGTTATCGAAATAGGTCACTTACTGTACCTTGTCTCGCACCTCCACTACCGTCCGGAGTAAAGCACCAGTGCACGATGGTTAGTATCCGTAGCTACAAGCGCTAGTTTTTCCTCCAAGTTATTGGGGGAAGGAAGTCCGCCCGTTGATATTCCAAGGTCCTATCTACGAAGTGAAACTAGGTCTGCCAAATTAAGGGGACCTATTCCCTTCATCTATGTGACGCCTCCGCTGTATGGGAATTAACATAGGTGCAGCACCCGGACGAGCGTTTCTGGCCTCACCGTATCCGAACCCAGGGTAGGGTATCGTACCACGAAAAGAACAGCCGCTAATTGGCTGAGAGTATGCAATAGATATGAAATGTGACCCAAATATCGTCCGTCCTTGACAAAGAAGTAAAGGGCTACTGATCGTCTTTAATCGAACCGCTCGTCGGGTGTAATCGTTAATGGCGTAGACCGGCCCTTGTTGTATCATTGTCACGGCGTAATTCGACTACGTCAGTAGAAGGAATGAGTGGTCGGAGTCAAGGTCACTTATTGTTTCACGCCGGTGATTATAGAGAGATTAAGACATCCATAGCAATTAGCAATTTCCGGTCGGATTCCGAGACGGCTCGCAACTGAAACCTCGCCGAGCGAGTGAGGAGCCAAGCGCAGCCTGGGGCAATTTTCAACGCTCTGTTGCTGACTAACTTATATTATTTTAGTGACAAAACTACATTACGGTACGCAGACATCCCCCGAGAATAGTTTAGACTACAAGCGCTGTAGCGTGCTTGCAGAGCGCATACCGAATTTGACCACAATTGAACGTCGCGGATCCGTACGAGAAGAAATCGCAACCTAGGTCGGGAAGCCGTACGGCACTCATTGATCTTCTCTACAGACAAACGCCGCCCTCTGCAAACTGAGGGCCGAGGCATTGACCCGGGGGTAGTCAAGGATAGATCAATGAGTATAGACCGCGGTTACTACATACGACCGACGCATTTGATTGTCAGCGTGTAGAAGTCTACTAAGTTGACGGGCACGGCGTCCTGGGTCATAGAAGTTTCTGCAACGGAATTCGACAGCAGCGTATGTAGTCAACTTACTGGATAGCAAATACGTTCTGCCGTCTTGTTGCTAGGGGTACGTCCGGGGCAGATAGGAATGTCTGAGCCGACAACACATTCCCTAGCTACCTCGGGCAGGACACCCTTTGGAGGTGGCCGTTGGTCCTTCACGGAACGGTATCCTCTTCCTAAACCCCGCCTATGTATATCGATCACATCGCCTGTGACGCGACGTAGGATAAGACTCCCGTTCGGGTACAGTCTCCACCGTGGCGCCAGTAGCATCAACTTCGGCGGCGAGCCTAGGCTCGAACTAGGCCAGGTGACCGTAAATCTCGTCATAAGCCGCACTCTGAAGGAGCTAACTGCGAACTTGTTTCTTACCCAGCGGTACGAAAATCAAATGTACTGGGACGCCGTGTACTCCCGCGGTGACAGCTTTGGGGGAGTGCGCCCCAATATTGCACGCCTAGCAGACACACAGTCCTTTTTGTAATTGCCGTATTAGCCTTGCTGGCACAGCACGGCGCTGTGATTACACCACGGTCCCGGATAGACCATCTCGCGAGCGAGCAGCCAACCGATTATTGCCCGAAGCGGCGATGTTCAGGGAACGTGGGTCTACATTAGCAATTGTCTACTCGTTCCGTTCCCCGCCCATCACCTAGTGTGCTGCGAGGAGGGCGGGGTGTACGGGTGTTCGGCCTCCGATCACGAGTTTTGGAGGGATATGCCGTAGCCTAGTTACCATCGGTGCGGGCTGATACGTTACTGGATGTTATAGAGCTGTCGAATGTTGTGATCCTTACGACACCACCCGGTTTATCAGGTACATATAATTAGAGGTTGAGCGTATTCCTCTGTAAGCTCCTGTGGGCGGTCACTTAATTAACAGGACTTTCCATTCCAACGCGTGACGCTAAACTGAAAGGGCGGCAGTAGTCGTCTTCACAGGTCCTTCGGAGGATCTTTCGTCGCGGATGCGCGGCTGCCTAACGCGCCGGGGCTTCGGCCTATGGCAATTGCTGGGAGTGCATACCCGAGGCCACACACCCGCCTGGTTGTTATTACCGCGTAAGTCGAAGCCCATCCACAGAATCCGTGGGCCCTCCACGTCTAACCGGTGTTCTGTCTGATGAGATGATTATGCATCCACGGACACTGATGTGATCTAACACCGACTCGCCGGTCTTGTCTGGTGGTGCCGAAAACACTCGCATTTTCGTCAATAACACCAGGATATGAACGCCCGAGGCTGGAGGACAAACCTCTAGGGCGGCGCGCTTAGGATAGGCGAGCACTCTGTAGCCTAATCAGATGATTCTCAGCGCAGGGCGTTCACTCTAGCTTCGCCCAACCGCTTGGTAACGGTGTGCACCTGGAGCACTTCACAGCACCGGGCCAGGAGGTATCTGAGAATTACATCCGGAAAGTAGCCGAGCACATGTTACCTTAGCTACCCCCTAGCTTCCGTTATTGGAATAGGTTCATTACAACACCCCGTGACCAACCCTTAATTCTCTGGACCCACTGAAAGGGATCGAACTCCCCTATTCTGCCCCGGTCCGGAGGACCCAACACTGCTAGGGGGGATAGCAATCGGTACCCAAGATATCATCAACCTGCAAATAGAACCGACTTCCAATTCATTACGTGATTGAAACGCCGACCGTCCAATAGAAATTGTATTACAATCACCAGTATCTAGTTGCCTGTAAGAATTACAGTCTTGCCCCGGGATCCGGGAAAGCATCGGGTGAATCCTCGACGGCACCGAGTGACGACCATAAGGAGGGTGTGAGGATTAGCATATGTGGTGGTTCCATAGATCACAGCCGAACTGATGTGTCATAACGAGTAACGCAACAGATGCGACGTTGGTGCTGGGGCCTCTCTTACAATTGGAGAGCACTGGCGAGGAGGTAAAGTGTCTGTCATATTCACGCATGCGATATACAGAGATGGGCGGATTGGAAAACACACGCTTACATAAGCAAATTCGAGATTAGAAGGTCAGAGAAGTTGCGAATTACTTTGCGGAGACGAATTGGGCTCATAGCGCCCGTCGTCCATATTTACTAAGATCGACCCGAGAACATATCTTCCCACGCCCAGGTGCCGAGGTTTGCTCAAACGGTATTAGAAAAAACCCCTAATTTTGGGTGTAGCTAACATATAAGCTGAGGGTACGGGATTAAGGCTAGTCCGCTTCGGCTCCATGGCTTATCCACGGCTTTGGCTGCAGTGGACGGCTTGGAGTGTGAACCTCCTAAGATAGGAAGGATCCATTGGCAGTCAATGCCTAACGTAGTTCTCGTTAGTGGTACGAGGCTCCAACCCAAGCGGCGGTGGTTCCGCGGTCCATTCGAGAGATGGATACTCAATAAAGGTAGAAAGCGGATGAAGACAATATTTGCAGACTAATCAACTACCCCCAACAGCTCTGCTGCTGATTGGCTCGCAAATCTAACATAAGTGGCAAGTGACCACTTCTCACCCGTAAAAGGGATGATTTATAAGATGGCACACATGAAGCTAATAGCAAGTCCCATAGCCCGCATGATGTAGCCGAGAAGAACCTCTTAGGGCTAGGGCTATGGCGTTCTATCGTTCTCTCACGAGACACTACCCGTGTGACTTACACTGCTAATCGCTTCTACCCGAATACTGCGAACTAACCCGGGGGCATAGTTTCCCCCTTGAGCCATCTTATCTTACTCATTGGAGAACCGCATAGCTGAGCGGCATGTCATTCCTCGGTCGACCCAGTAAGAGGAAAGCGGGAGAGATGGCCCACACCGAGTAGGAGTGGCGGGGTCAGGTCAGCCAAACACTACACCCTGGAAGCATGCGTTATCTGGACTTCTACGAGGAGCATAAAATTTGTCCATCTAGCTACCAGCGTGTATGGGAAGCTGCTGGCAAGTTGAGCGCGCATCCGCGATGGTCTTCTGATGTGGTCGCAATCCTGAACCGCCCCCGCTAT', 11) as k(kmer);

-- insert into large_table (kmer)
-- select k.kmer
-- from generate_kmers('TCATCTAACCGTGTAGTCTCGCCAATATTGAATGAACGGGAGGCAGGTGATATAGACCCGAAGGTTTCCTCTCGACAAATCGGAAGTGTTATGAGTCCCTCGGAAGGACTAGATATATTACATCGGATACAAGGTCGCTTGAGGAAACTTGTGTAGAACACAATTATCGGGACCACGGCGAGCGCTCATCTTCGGATGGTAGCACAGACACGCCTCCCGAGAGTATTATTTCGGAATTTCTACTGAACCACGAATCAAGAGTGCCAGAACATAGCGTGCCGAATTGACATAGACGGTTCTCCGCGGCCGGGGCTTCAGCAGAGACGTACAGCTTCACGAACCCCGTCATGGCGACGTTTAGTTGATAACGAAAGGCGGGGACTACAGAAAGAATCGTCACACTCCAAATTAGTTCCCTGTATTTCAGCATATCCCCCGCGTAAGTACTCAGAAATGGCATGGCATCTACATCCAATCCTCGAGCTAATTGCTGATCGGAGCCCCTTAGCTGCCCGTGTTGGGGGGATGGCCACGATTTTGGTCGGAACCTAGGCTAAGAGGTCTCAAACCTCACACTTTGTGGAGCATCTTGCCCACCTAAATCAAAGATCCTAGCCTGTGTTAGATAGCACAAGGTTCTTGATCTCTGTTCGAACGGATGAATCGTCTGTCCGTCTGATGACTAATTAGTGTACCTCCCGCATTTCGAGCTGCCGCAAACACGCGTTTCGTAACTCTTGAATGCGAATTCAAGCCATCAAAACTAGCCGGCAGCCGGGGACAGTTATTGCAGGTCTCTCTTCTTAGGCTACGCGTCTCGGCTTAGCGATACGTTCGGGCGAGTTCTGCTGGTGAGCATTCCCATCAGCCGGGCAGGGGTAGCAGGGCGCATGCCCTCAGCGGATGTGCAATGTTATGATTGTCAGCGCTGGGTACTAGCCGAAACTCCACGGCTTGGATTGGGCATAAAGCCGTTGTGATGGTACCGCTTACGGCGATAAACGGGGTCGGACGATGTCGGAAGAAGCCAGCACGAACTTAAGCACGGTAGAACGGAGATTGTTCTTTACCTATAGTGCCGGGATAATGTCTCGATAGTCCATGCCCAGTTATTCCCGTCCCGTACTCAGGAAGGGTGTGGCGAATGTGTTCGGTTGCATGTCCGGACCCGCGGTCCAGTCAGGCTCGATGGTGCTCTATCAAAGTCCTTTGTCACGGACTTGCGAATGCACGTGTTTATCAGGCGAATAGTGACCTTCGTCACGGACGCCGCGTCCTGTCATCCGGGCCGCGGTTTTCGCAGCATCCATGGGCAGGCGCGTCTGCACGCCCTGCGGCACAAACTACACACTGATGAAAAGTCGTCTCTTGGTTGGACAACGAGAGCGGGCGGTAAAACGGTACGTGATCGGCTTGCGGAGCCATGTTAGGGAACTAGGTACGGAAGCCGGCAGGGCACCGAAGTTCGTATTGTCAAGCCTCCACCCGGACATTAGTGGCATATCTTCAGAAGCTGGGTGCAATAGTTAATAATCCTGCGGTCATACGCCGGTCCCGCGTTTTCATCAATGGAGACCATTTTGCGATGCAGATAAAGGTCGCGATACACTGGGTCGGTGCACTTGACTTATCTGTGTTGAGCTCTTCGTAAGGACTCCCGTCGCCCGAATCCCAGAAAACCGACGCAGGAAGACACGTTCGTCGCGCTAGGCGGGTGGAAGGGTTGCTCCAGAGTGGCCTATGCTAGGGCGTGTGGCACTGGTAAGAATCGGAGCAGTATCCGAACCGGATGGACCAACACGTATTAGAGAGATACATTTTATTTGTCGGTCTTCATATCATTAGGCGTGAGCAGCCGTTTACACAGCTAGGCCCGATGCTTAGAATCGTATCAGCCAATATCTTTACTCGTACGAAAGGTGCCTGAGGTGCATTGGGAACTTCATTCGGGGCCGTTTGTTACTGAGGACCTTGAGTACATAGTTGGGGAATTGTCGTTATGTATTCTCTCCTCTAACAACCAGATTCCTGGTTTGAATGTGTATAACGAAGTCGCGCAGTCCCTCTCAGATTGATCGGTGGTTGAGGGCTACCGATCGTTTCCCATTGCGCACGCAAGTACAGGCAGCTGCTGGCGGAGGCATTGCATAGGGTAGAGGGACGCGATATTCGCCTTCTGGACGCGTGCGATTGTCCCCGCATTTTCTCAGTCGGTATGAATAAAGAGCGTGGGCCAATTTCGGCAACATGAAAACAGCTCTGGCCGCTGAGCCTAGTACCTGCGCTTACACCACGTTTGCCCGCGTCCAAACATGGGGTAGCCATGTGCATAACTCTCTTGTCGCTGGTCCTCGTGACAATATCGTTCTTACGAAATTTAAGGGGAATGGGCCCCCCTTTCCGTAAAAGGAGTCATAAGTGTGGGGCCCTCCGTCGGGAGACGGCTTCACCAAGCTCGATCTCACTGCACAGGAAGCCACCAATTCCAGATTGACTTTTTTTGCTTTAAACTTGGGTAGTGCTAGAAGTCTTCCGCTAACATCCTCGATCTCCTGTGCGACAAGGACGCCCGATCACCAGCCCTCAAGCAATATGCGTGATGTGGAGCCCCAGAGCCTGCTCATATGCAGAAACACATGAGTAGAGCAGCCGCCATGGAATAACATGAGCGTGGCGCTTCTGATAAGGGCGCGAGAGGGCCACAGTTATGCGTTGTCGTAGGGTCCGCACCCTCTCTCTTGTCCGCTTATGAAGATAAGGAGGGAACGCAGCCAACTAACTAGTTTTCTCGTATGCCTTCAAGAGGATCCTTCTCGATTGGCAATTCGTCTGATGATAGAGCAGCTACTCAATTCCCTCACCTCTTACGTCTAAGAGAAGCTTTGAGAGTATGCTGACGCTCGGCAGCATTCGCCTCGGGACCCGAGTGATACCGAACATTCATCCTCCTGAATTGAGCAGAATGGGTATTGATAAAACATTTTTTGCGTGAGTACGGAATTTGGTGGAATGCCGTGGGGGCCTGCCCAATACCACCCTCCCTGTAAAGCTCTGTCCTGGTTCATATGATCCGATCCCAAGACTTAGCGTATTTGATATCTTGTCGTCGCTAGTGAGCTGTAATGAGATCCCCCCCAACTAACCACCTCCGGTCCGTGCGAACCTAAACTGAATTTTAGTGTATATTCGATTTACTAAATTCTTATCTAAGTCTAGTATCATATTAATCTATGGGCTGAAAGTGATACTTCCACCGTTGACGGGGGAATGGATAACGGAATAGTGGGTAGGTACCCCTGATACTGCCTGACAATCTCGGGCTCGACAATTAATTTGATTTCGCGCTGTCTAATCCATCTTATTGTGTCGCTTATAGAGTCGCGTTAGATGATACGATCAGAGATCGCCTATGCACTTTGCACTGGCATAAGCGTAGCGAATCCCCCTCAACAGATAGCCAGAATTCCCCATCCAGCGAGTGGGGTTATCTTCTTCAAGCTTGCCGCTTTACGTGTGGAACGTGCACATAATTACGGTCCCGCTATCGGTGCCCCCTGCTCGGAGAGGGGGATCGGCACCTTGGAGTCTGGCGAACGGAGGTAGAATCTCGTGATAAAAGTATGAGAGTAGACCGTAGATAAGATCTACGGGATTCGACGGCCCGTCTTGCGGTGTGTTTTGGCGAAAGGTTCCCATCCCCACGAGTCCTCAGTGTACGGATTTACCTGTGCCTTAACCAGAACCCCCGGTGGTACCTCCGCCGCGCGGATTTGCAAATGAACGCACGATTCTATTTGTCTATGCCATGCATCAACATGCGGAAACCTAAAAAGGTTTCCTTTAACTTTGAGGTTACCGTTTACGGACAGTACCCTCTAAGAAGTTGGCTGAATACAGGGAAAGACCAACAGGATCCTATGTGGGTGCTGCGAAGTACGCGGTCTTGGTATACCGCACTTCTCGAAGAAGAGGACCGTGGAACTGATACTCTAACTCGAAAGGGGTGCGTCCCGAAACTGTGCTAAACATGGGAACACACTTTATAGAGCCTGTCGGGACTCATAAGTCAGGTCAGTGTTTCTCCCTTGAATGACAGTACTTCTTACATAGAAACAGCTCATTCATTCGAGTCAGGAGGCACAAGATGGCGTGTAAAGGGCCGCCCCGGCGTCGGATTAATAAATTAACTTCGGGCGCACCAAGGCCAGGGTATGAATGTGCCTTCTAACCCAGGTCGCAAAAGACCGCACTTTCGACACGGGCCTGTAGCATGGTCCTTTCCAGACAATTGATTATCTTCAAGACCTTCTAACGTAGTCATTGGTGGTAGTACACAACGTCGACTCCCAGGACAGTTTCGTGCTCAAATAAGTTTCGGGATAGGTGACTCGCTCGGGCATTATTGACAGGCTCACTAAGAGAGCGTCTGTTACTATATGTGGGCACACGCACCAGAGTAGAACGGCAAAGTCCCTCAATGCCGATTCACATATACGCCGTGGGCCCGATGGCGGACAGCACCGAGATTACTGCTTGCGACTAAAGCGAGTCAGGCGGACTCAAGTGGATGAACCGTGGTGCTCAAACGCAGGGCTGGGCGGAATGGAGGATGTACCAATATGGAAACTAATTCTGTCGGCAAGAGGGCATCCACTGTCCAAACCGGAATTAGCCCAGTGGCCCTGACCCTCCGCTAAATGCATGCCTTGTAAGGATCCATGCAAGGATCTCCTTTCATAATTAACCCAGTTCTGGCCAATAGGTTCTTGCTAGCCACGCTCTCCTTCTCGGATATTAACCCACTGATCGGGGCCATTTACTTACCCAACAGGAAACGCGGCCCTCGATTCATCTCGGGGTGGGCCATTAGTGGGTTGTCCCGAACAGGATCACCCACATCAAGCGGGGGACTTGATCTGCAAGTAGGGCGTGACAGTGAACGACGGATCACTTTTGTTAGGGTGATGCTTTTGTGCCTGATTTCCCTCCCAAATCTTGGA', 7) as k(kmer);

insert into large_table (kmer)
select k.kmer
from generate_kmers('CCGGGCACTAGGGGGCACGGCCCTTAGATAGTGCGAATAGTGCCTATGCATAAACACATCAGAAGTCAGATTTGTACTTACCGGCCCGTTTGATCACATCACTTAGAATAAATAAAAACTGAGTACGTAGCGACTAACGAACTGTTATGAATTCTAAGGCCCAATCCCTGAGAATAGCGTAAGGATCCAAAACGTATGCCACAGACTGGTAATTCACAACCTTAGCTTGCAGGGGATGGGTTGATCGAAAGAGGAGCATATCGACTATGGTCCCAGGGGTCTCCCCGTCCCCATATTCGCGCTCATGGATAGTAGTCACGTCGTTCAGAGCATACACGGGTGCAATGATTCTTATATGGTGCCGATATAATAATACGGGGCCACCTCCGTTATCAATAACATTGATCTCAGTAGTGAGTGTAACCTCAATACATTCGCACGTGATAGTGTGGCATAAAATAACCATCGACAATCAAAACTATTGAGATCAATTGTCGAGGAGATTTCTTCATCTGAAGTAGTCACAGGTAGTATGGCTTCGTGAGACCCTGCACATTCGGCAGTCCTCGCGGGGAAAGACCACTCCGATGTGTTCTGATGGACTAAGGCTCTGCCAATCCTTCAACGACTCGCCAGTTTCATTATTCTATGACGAACTTGCACACGGGATCGTCAATAAATAGTTATGGTACGTCTGACACTTGCTACGAATCTACTAACAACGCTCACGTTTATGTCCAATACAGAAACATACCGGTTTGCTCCACGGTAGCGACGAACGAAAAGCGAGGCAGGGACGATTCCGGTTGGCAATTGCAATACTCTCCAAACTTCCACGTTAAAACTAGTTGTATAAGCGAACTCTAATGCGGCGTGCAAGGGGCGGAAACAGTGCGCCGTCTGACCTGGATTTATCAAAGGAACTTGCAGGTCTGGTATGTGTTGTTCAATCACGGAGTTATCGAAATAGGTCACTTACTGTACCTTGTCTCGCACCTCCACTACCGTCCGGAGTAAAGCACCAGTGCACGATGGTTAGTATCCGTAGCTACAAGCGCTAGTTTTTCCTCCAAGTTATTGGGGGAAGGAAGTCCGCCCGTTGATATTCCAAGGTCCTATCTACGAAGTGAAACTAGGTCTGCCAAATTAAGGGGACCTATTCCCTTCATCTATGTGACGCCTCCGCTGTATGGGAATTAACATAGGTGCAGCACCCGGACGAGCGTTTCTGGCCTCACCGTATCCGAACCCAGGGTAGGGTATCGTACCACGAAAAGAACAGCCGCTAATTGGCTGAGAGTATGCAATAGATATGAAATGTGACCCAAATATCGTCCGTCCTTGACAAAGAAGTAAAGGGCTACTGATCGTCTTTAATCGAACCGCTCGTCGGGTGTAATCGTTAATGGCGTAGACCGGCCCTTGTTGTATCATTGTCACGGCGTAATTCGACTACGTCAGTAGAAGGAATGAGTGGTCGGAGTCAAGGTCACTTATTGTTTCACGCCGGTGATTATAGAGAGATTAAGACATCCATAGCAATTAGCAATTTCCGGTCGGATTCCGAGACGGCTCGCAACTGAAACCTCGCCGAGCGAGTGAGGAGCCAAGCGCAGCCTGGGGCAATTTTCAACGCTCTGTTGCTGACTAACTTATATTATTTTAGTGACAAAACTACATTACGGTACGCAGACATCCCCCGAGAATAGTTTAGACTACAAGCGCTGTAGCGTGCTTGCAGAGCGCATACCGAATTTGACCACAATTGAACGTCGCGGATCCGTACGAGAAGAAATCGCAACCTAGGTCGGGAAGCCGTACGGCACTCATTGATCTTCTCTACAGACAAACGCCGCCCTCTGCAAACTGAGGGCCGAGGCATTGACCCGGGGGTAGTCAAGGATAGATCAATGAGTATAGACCGCGGTTACTACATACGACCGACGCATTTGATTGTCAGCGTGTAGAAGTCTACTAAGTTGACGGGCACGGCGTCCTGGGTCATAGAAGTTTCTGCAACGGAATTCGACAGCAGCGTATGTAGTCAACTTACTGGATAGCAAATACGTTCTGCCGTCTTGTTGCTAGGGGTACGTCCGGGGCAGATAGGAATGTCTGAGCCGACAACACATTCCCTAGCTACCTCGGGCAGGACACCCTTTGGAGGTGGCCGTTGGTCCTTCACGGAACGGTATCCTCTTCCTAAACCCCGCCTATGTATATCGATCACATCGCCTGTGACGCGACGTAGGATAAGACTCCCGTTCGGGTACAGTCTCCACCGTGGCGCCAGTAGCATCAACTTCGGCGGCGAGCCTAGGCTCGAACTAGGCCAGGTGACCGTAAATCTCGTCATAAGCCGCACTCTGAAGGAGCTAACTGCGAACTTGTTTCTTACCCAGCGGTACGAAAATCAAATGTACTGGGACGCCGTGTACTCCCGCGGTGACAGCTTTGGGGGAGTGCGCCCCAATATTGCACGCCTAGCAGACACACAGTCCTTTTTGTAATTGCCGTATTAGCCTTGCTGGCACAGCACGGCGCTGTGATTACACCACGGTCCCGGATAGACCATCTCGCGAGCGAGCAGCCAACCGATTATTGCCCGAAGCGGCGATGTTCAGGGAACGTGGGTCTACATTAGCAATTGTCTACTCGTTCCGTTCCCCGCCCATCACCTAGTGTGCTGCGAGGAGGGCGGGGTGTACGGGTGTTCGGCCTCCGATCACGAGTTTTGGAGGGATATGCCGTAGCCTAGTTACCATCGGTGCGGGCTGATACGTTACTGGATGTTATAGAGCTGTCGAATGTTGTGATCCTTACGACACCACCCGGTTTATCAGGTACATATAATTAGAGGTTGAGCGTATTCCTCTGTAAGCTCCTGTGGGCGGTCACTTAATTAACAGGACTTTCCATTCCAACGCGTGACGCTAAACTGAAAGGGCGGCAGTAGTCGTCTTCACAGGTCCTTCGGAGGATCTTTCGTCGCGGATGCGCGGCTGCCTAACGCGCCGGGGCTTCGGCCTATGGCAATTGCTGGGAGTGCATACCCGAGGCCACACACCCGCCTGGTTGTTATTACCGCGTAAGTCGAAGCCCATCCACAGAATCCGTGGGCCCTCCACGTCTAACCGGTGTTCTGTCTGATGAGATGATTATGCATCCACGGACACTGATGTGATCTAACACCGACTCGCCGGTCTTGTCTGGTGGTGCCGAAAACACTCGCATTTTCGTCAATAACACCAGGATATGAACGCCCGAGGCTGGAGGACAAACCTCTAGGGCGGCGCGCTTAGGATAGGCGAGCACTCTGTAGCCTAATCAGATGATTCTCAGCGCAGGGCGTTCACTCTAGCTTCGCCCAACCGCTTGGTAACGGTGTGCACCTGGAGCACTTCACAGCACCGGGCCAGGAGGTATCTGAGAATTACATCCGGAAAGTAGCCGAGCACATGTTACCTTAGCTACCCCCTAGCTTCCGTTATTGGAATAGGTTCATTACAACACCCCGTGACCAACCCTTAATTCTCTGGACCCACTGAAAGGGATCGAACTCCCCTATTCTGCCCCGGTCCGGAGGACCCAACACTGCTAGGGGGGATAGCAATCGGTACCCAAGATATCATCAACCTGCAAATAGAACCGACTTCCAATTCATTACGTGATTGAAACGCCGACCGTCCAATAGAAATTGTATTACAATCACCAGTATCTAGTTGCCTGTAAGAATTACAGTCTTGCCCCGGGATCCGGGAAAGCATCGGGTGAATCCTCGACGGCACCGAGTGACGACCATAAGGAGGGTGTGAGGATTAGCATATGTGGTGGTTCCATAGATCACAGCCGAACTGATGTGTCATAACGAGTAACGCAACAGATGCGACGTTGGTGCTGGGGCCTCTCTTACAATTGGAGAGCACTGGCGAGGAGGTAAAGTGTCTGTCATATTCACGCATGCGATATACAGAGATGGGCGGATTGGAAAACACACGCTTACATAAGCAAATTCGAGATTAGAAGGTCAGAGAAGTTGCGAATTACTTTGCGGAGACGAATTGGGCTCATAGCGCCCGTCGTCCATATTTACTAAGATCGACCCGAGAACATATCTTCCCACGCCCAGGTGCCGAGGTTTGCTCAAACGGTATTAGAAAAAACCCCTAATTTTGGGTGTAGCTAACATATAAGCTGAGGGTACGGGATTAAGGCTAGTCCGCTTCGGCTCCATGGCTTATCCACGGCTTTGGCTGCAGTGGACGGCTTGGAGTGTGAACCTCCTAAGATAGGAAGGATCCATTGGCAGTCAATGCCTAACGTAGTTCTCGTTAGTGGTACGAGGCTCCAACCCAAGCGGCGGTGGTTCCGCGGTCCATTCGAGAGATGGATACTCAATAAAGGTAGAAAGCGGATGAAGACAATATTTGCAGACTAATCAACTACCCCCAACAGCTCTGCTGCTGATTGGCTCGCAAATCTAACATAAGTGGCAAGTGACCACTTCTCACCCGTAAAAGGGATGATTTATAAGATGGCACACATGAAGCTAATAGCAAGTCCCATAGCCCGCATGATGTAGCCGAGAAGAACCTCTTAGGGCTAGGGCTATGGCGTTCTATCGTTCTCTCACGAGACACTACCCGTGTGACTTACACTGCTAATCGCTTCTACCCGAATACTGCGAACTAACCCGGGGGCATAGTTTCCCCCTTGAGCCATCTTATCTTACTCATTGGAGAACCGCATAGCTGAGCGGCATGTCATTCCTCGGTCGACCCAGTAAGAGGAAAGCGGGAGAGATGGCCCACACCGAGTAGGAGTGGCGGGGTCAGGTCAGCCAAACACTACACCCTGGAAGCATGCGTTATCTGGACTTCTACGAGGAGCATAAAATTTGTCCATCTAGCTACCAGCGTGTATGGGAAGCTGCTGGCAAGTTGAGCGCGCATCCGCGATGGTCTTCTGATGTGGTCGCAATCCTGAACCGCCCCCGCTAT', 11) as k(kmer);

insert into large_table (kmer)
select k.kmer
from generate_kmers('CCGGGCACTAGGGGGCACGGCCCTTAGATAGTGCGAATAGTGCCTATGCATAAACACATCAGAAGTCAGATTTGTACTTACCGGCCCGTTTGATCACATCACTTAGAATAAATAAAAACTGAGTACGTAGCGACTAACGAACTGTTATGAATTCTAAGGCCCAATCCCTGAGAATAGCGTAAGGATCCAAAACGTATGCCACAGACTGGTAATTCACAACCTTAGCTTGCAGGGGATGGGTTGATCGAAAGAGGAGCATATCGACTATGGTCCCAGGGGTCTCCCCGTCCCCATATTCGCGCTCATGGATAGTAGTCACGTCGTTCAGAGCATACACGGGTGCAATGATTCTTATATGGTGCCGATATAATAATACGGGGCCACCTCCGTTATCAATAACATTGATCTCAGTAGTGAGTGTAACCTCAATACATTCGCACGTGATAGTGTGGCATAAAATAACCATCGACAATCAAAACTATTGAGATCAATTGTCGAGGAGATTTCTTCATCTGAAGTAGTCACAGGTAGTATGGCTTCGTGAGACCCTGCACATTCGGCAGTCCTCGCGGGGAAAGACCACTCCGATGTGTTCTGATGGACTAAGGCTCTGCCAATCCTTCAACGACTCGCCAGTTTCATTATTCTATGACGAACTTGCACACGGGATCGTCAATAAATAGTTATGGTACGTCTGACACTTGCTACGAATCTACTAACAACGCTCACGTTTATGTCCAATACAGAAACATACCGGTTTGCTCCACGGTAGCGACGAACGAAAAGCGAGGCAGGGACGATTCCGGTTGGCAATTGCAATACTCTCCAAACTTCCACGTTAAAACTAGTTGTATAAGCGAACTCTAATGCGGCGTGCAAGGGGCGGAAACAGTGCGCCGTCTGACCTGGATTTATCAAAGGAACTTGCAGGTCTGGTATGTGTTGTTCAATCACGGAGTTATCGAAATAGGTCACTTACTGTACCTTGTCTCGCACCTCCACTACCGTCCGGAGTAAAGCACCAGTGCACGATGGTTAGTATCCGTAGCTACAAGCGCTAGTTTTTCCTCCAAGTTATTGGGGGAAGGAAGTCCGCCCGTTGATATTCCAAGGTCCTATCTACGAAGTGAAACTAGGTCTGCCAAATTAAGGGGACCTATTCCCTTCATCTATGTGACGCCTCCGCTGTATGGGAATTAACATAGGTGCAGCACCCGGACGAGCGTTTCTGGCCTCACCGTATCCGAACCCAGGGTAGGGTATCGTACCACGAAAAGAACAGCCGCTAATTGGCTGAGAGTATGCAATAGATATGAAATGTGACCCAAATATCGTCCGTCCTTGACAAAGAAGTAAAGGGCTACTGATCGTCTTTAATCGAACCGCTCGTCGGGTGTAATCGTTAATGGCGTAGACCGGCCCTTGTTGTATCATTGTCACGGCGTAATTCGACTACGTCAGTAGAAGGAATGAGTGGTCGGAGTCAAGGTCACTTATTGTTTCACGCCGGTGATTATAGAGAGATTAAGACATCCATAGCAATTAGCAATTTCCGGTCGGATTCCGAGACGGCTCGCAACTGAAACCTCGCCGAGCGAGTGAGGAGCCAAGCGCAGCCTGGGGCAATTTTCAACGCTCTGTTGCTGACTAACTTATATTATTTTAGTGACAAAACTACATTACGGTACGCAGACATCCCCCGAGAATAGTTTAGACTACAAGCGCTGTAGCGTGCTTGCAGAGCGCATACCGAATTTGACCACAATTGAACGTCGCGGATCCGTACGAGAAGAAATCGCAACCTAGGTCGGGAAGCCGTACGGCACTCATTGATCTTCTCTACAGACAAACGCCGCCCTCTGCAAACTGAGGGCCGAGGCATTGACCCGGGGGTAGTCAAGGATAGATCAATGAGTATAGACCGCGGTTACTACATACGACCGACGCATTTGATTGTCAGCGTGTAGAAGTCTACTAAGTTGACGGGCACGGCGTCCTGGGTCATAGAAGTTTCTGCAACGGAATTCGACAGCAGCGTATGTAGTCAACTTACTGGATAGCAAATACGTTCTGCCGTCTTGTTGCTAGGGGTACGTCCGGGGCAGATAGGAATGTCTGAGCCGACAACACATTCCCTAGCTACCTCGGGCAGGACACCCTTTGGAGGTGGCCGTTGGTCCTTCACGGAACGGTATCCTCTTCCTAAACCCCGCCTATGTATATCGATCACATCGCCTGTGACGCGACGTAGGATAAGACTCCCGTTCGGGTACAGTCTCCACCGTGGCGCCAGTAGCATCAACTTCGGCGGCGAGCCTAGGCTCGAACTAGGCCAGGTGACCGTAAATCTCGTCATAAGCCGCACTCTGAAGGAGCTAACTGCGAACTTGTTTCTTACCCAGCGGTACGAAAATCAAATGTACTGGGACGCCGTGTACTCCCGCGGTGACAGCTTTGGGGGAGTGCGCCCCAATATTGCACGCCTAGCAGACACACAGTCCTTTTTGTAATTGCCGTATTAGCCTTGCTGGCACAGCACGGCGCTGTGATTACACCACGGTCCCGGATAGACCATCTCGCGAGCGAGCAGCCAACCGATTATTGCCCGAAGCGGCGATGTTCAGGGAACGTGGGTCTACATTAGCAATTGTCTACTCGTTCCGTTCCCCGCCCATCACCTAGTGTGCTGCGAGGAGGGCGGGGTGTACGGGTGTTCGGCCTCCGATCACGAGTTTTGGAGGGATATGCCGTAGCCTAGTTACCATCGGTGCGGGCTGATACGTTACTGGATGTTATAGAGCTGTCGAATGTTGTGATCCTTACGACACCACCCGGTTTATCAGGTACATATAATTAGAGGTTGAGCGTATTCCTCTGTAAGCTCCTGTGGGCGGTCACTTAATTAACAGGACTTTCCATTCCAACGCGTGACGCTAAACTGAAAGGGCGGCAGTAGTCGTCTTCACAGGTCCTTCGGAGGATCTTTCGTCGCGGATGCGCGGCTGCCTAACGCGCCGGGGCTTCGGCCTATGGCAATTGCTGGGAGTGCATACCCGAGGCCACACACCCGCCTGGTTGTTATTACCGCGTAAGTCGAAGCCCATCCACAGAATCCGTGGGCCCTCCACGTCTAACCGGTGTTCTGTCTGATGAGATGATTATGCATCCACGGACACTGATGTGATCTAACACCGACTCGCCGGTCTTGTCTGGTGGTGCCGAAAACACTCGCATTTTCGTCAATAACACCAGGATATGAACGCCCGAGGCTGGAGGACAAACCTCTAGGGCGGCGCGCTTAGGATAGGCGAGCACTCTGTAGCCTAATCAGATGATTCTCAGCGCAGGGCGTTCACTCTAGCTTCGCCCAACCGCTTGGTAACGGTGTGCACCTGGAGCACTTCACAGCACCGGGCCAGGAGGTATCTGAGAATTACATCCGGAAAGTAGCCGAGCACATGTTACCTTAGCTACCCCCTAGCTTCCGTTATTGGAATAGGTTCATTACAACACCCCGTGACCAACCCTTAATTCTCTGGACCCACTGAAAGGGATCGAACTCCCCTATTCTGCCCCGGTCCGGAGGACCCAACACTGCTAGGGGGGATAGCAATCGGTACCCAAGATATCATCAACCTGCAAATAGAACCGACTTCCAATTCATTACGTGATTGAAACGCCGACCGTCCAATAGAAATTGTATTACAATCACCAGTATCTAGTTGCCTGTAAGAATTACAGTCTTGCCCCGGGATCCGGGAAAGCATCGGGTGAATCCTCGACGGCACCGAGTGACGACCATAAGGAGGGTGTGAGGATTAGCATATGTGGTGGTTCCATAGATCACAGCCGAACTGATGTGTCATAACGAGTAACGCAACAGATGCGACGTTGGTGCTGGGGCCTCTCTTACAATTGGAGAGCACTGGCGAGGAGGTAAAGTGTCTGTCATATTCACGCATGCGATATACAGAGATGGGCGGATTGGAAAACACACGCTTACATAAGCAAATTCGAGATTAGAAGGTCAGAGAAGTTGCGAATTACTTTGCGGAGACGAATTGGGCTCATAGCGCCCGTCGTCCATATTTACTAAGATCGACCCGAGAACATATCTTCCCACGCCCAGGTGCCGAGGTTTGCTCAAACGGTATTAGAAAAAACCCCTAATTTTGGGTGTAGCTAACATATAAGCTGAGGGTACGGGATTAAGGCTAGTCCGCTTCGGCTCCATGGCTTATCCACGGCTTTGGCTGCAGTGGACGGCTTGGAGTGTGAACCTCCTAAGATAGGAAGGATCCATTGGCAGTCAATGCCTAACGTAGTTCTCGTTAGTGGTACGAGGCTCCAACCCAAGCGGCGGTGGTTCCGCGGTCCATTCGAGAGATGGATACTCAATAAAGGTAGAAAGCGGATGAAGACAATATTTGCAGACTAATCAACTACCCCCAACAGCTCTGCTGCTGATTGGCTCGCAAATCTAACATAAGTGGCAAGTGACCACTTCTCACCCGTAAAAGGGATGATTTATAAGATGGCACACATGAAGCTAATAGCAAGTCCCATAGCCCGCATGATGTAGCCGAGAAGAACCTCTTAGGGCTAGGGCTATGGCGTTCTATCGTTCTCTCACGAGACACTACCCGTGTGACTTACACTGCTAATCGCTTCTACCCGAATACTGCGAACTAACCCGGGGGCATAGTTTCCCCCTTGAGCCATCTTATCTTACTCATTGGAGAACCGCATAGCTGAGCGGCATGTCATTCCTCGGTCGACCCAGTAAGAGGAAAGCGGGAGAGATGGCCCACACCGAGTAGGAGTGGCGGGGTCAGGTCAGCCAAACACTACACCCTGGAAGCATGCGTTATCTGGACTTCTACGAGGAGCATAAAATTTGTCCATCTAGCTACCAGCGTGTATGGGAAGCTGCTGGCAAGTTGAGCGCGCATCCGCGATGGTCTTCTGATGTGGTCGCAATCCTGAACCGCCCCCGCTAT', 11) as k(kmer);

create index large_table_kmer_idx on large_table using spgist(kmer spgist_kmer_ops);
ANALYSE large_table;

SET enable_seqscan = on;
-- EXPLAIN ANALYSE SELECT count(*) FROM large_table where kmer ^@ 'AC';
SELECT count(*) FROM large_table where kmer ^@ 'AC';
SET enable_seqscan = off;

-- EXPLAIN ANALYSE SELECT count(*) FROM large_table where kmer ^@ 'AC';
SELECT count(*) FROM large_table where kmer ^@ 'AC';


-- select canonical(kmer), count(*)
-- from generate_kmers('ATCGATCAC', 3) as k(kmer)
-- group by canonical(kmer)
-- order by count(*) desc;


-- with mykmers as (
--     select canonical(kmer), count(*)
--     from generate_kmers('ATCGATCAC', 3) as k(kmer)
--     group by canonical(kmer)
-- )
-- select sum(count) as "Total kmers", count(*) as "Distinct kmers", count(*) filter (where count = 1) as "Unique kmers"
-- from mykmers;